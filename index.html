<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Crystal Docs 0.36.1">
<meta name="crystal_docs.project_version" content="HEAD">
<meta name="crystal_docs.project_name" content="zaru_crystal">



<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/doc.js"></script>

  <meta name="repository-name" content="zaru_crystal">
  <title>zaru_crystal HEAD</title>
  <script type="text/javascript">
  CrystalDocs.base_path = "";
  </script>
</head>
<body>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>
<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="index.html">
          zaru_crystal
        </a>
      </h1>

      <span class="project-version">
        HEAD
      </span>
    </div>
  </div>

  <div class="search-results hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class=" " data-id="zaru_crystal/Zaru" data-name="zaru">
      <a href="Zaru.html">Zaru</a>
      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<h1><a id="zaru-crystal" class="anchor" href="#zaru-crystal">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>zaru_crystal</h1>

<p><a href="https://travis-ci.org/szTheory/zaru_crystal"><img src="https://travis-ci.org/szTheory/zaru_crystal.svg?branch=master" alt="Build Status"/></a> <a href="https://sztheory.github.io/zaru_crystal/"><img src="https://img.shields.io/badge/docs-available-brightgreen.svg" alt="Docs"/></a> <a href="https://github.com/szTheory/zaru_crystal/releases"><img src="https://img.shields.io/github/release/szTheory/zaru_crystal.svg" alt="GitHub release"/></a> <img src="https://img.shields.io/github/stars/szTheory/zaru_crystal?style=social" alt="GitHub stars"/></p>

<p>Filename sanitization for Crystal. This is useful when you generate filenames for downloads from user input. Port of the <a href="https://github.com/madrobby/zaru">Zaru gem for Ruby</a>. </p>

<h2><a id="installation" class="anchor" href="#installation">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Installation</h2>

<ol><li>Add the dependency to your <code>shard.yml</code>:</li></ol>

<pre><code class="language-yaml"> dependencies:
   zaru_crystal:
     github: szTheory/zaru_crystal</code></pre>

<ol><li>Run <code>shards install</code></li></ol>

<h2><a id="usage" class="anchor" href="#usage">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Usage</h2>

<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;zaru_crystal&quot;</span></code></pre>

<pre><code class="language-crystal"><span class="t">Zaru</span>.sanitize! <span class="s">&quot;  what\ēver//wëird:user:înput:&quot;</span>
<span class="c"># =&gt; &quot;whatēverwëirduserînput&quot;</span></code></pre>

<p>Zaru takes a given filename (a string) and normalizes, filters and truncates it.</p>

<p>It removes the bad stuff but leaves unicode characters in place, so users can use whatever alphabets they want to. Zaru also doesn't remove whitespace– instead, any sequence of whitespace that is 1 or more characters in length is collapsed to a single space. Filenames are truncated so that they are at maximum 255 characters long.</p>

<p>If extra breathing room is required (for example to add your own filename extension later),
you can leave extra room with the <code>:padding</code> option:</p>

<pre><code class="language-crystal"><span class="t">Zaru</span>.sanitize! <span class="s">&quot;A&quot;</span><span class="o">*</span><span class="n">400</span>, padding: <span class="n">100</span>
<span class="c"># resulting filename is 145 characters long</span></code></pre>

<p>If you need to customize the fallback filename you can add your own fallback
with the <code>:fallback</code> option:</p>

<pre><code class="language-crystal"><span class="t">Zaru</span>.sanitize! <span class="s">&quot;&lt;&lt;&lt;&quot;</span>, fallback: <span class="s">&quot;no_file&quot;</span>
<span class="c"># resulting filename is &quot;no_file&quot;</span></code></pre>

<h2><a id="bad-things-in-filenames" class="anchor" href="#bad-things-in-filenames">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Bad things in filenames</h2>

<p>Wikipedia has a <a href="http://en.wikipedia.org/wiki/Filename">good overview on filenames</a>. Basically, on modern-ish operating systems, the following characters  are considered no-no (Zaru filters these):</p>

<pre><code class="language-crystal">/ \ ? * : | " < ></code></pre>

<p>Additionally the <a href="http://en.wikipedia.org/wiki/ASCII#ASCII_control_characters">ASCII control characters</a> (hexadecimal <code>00</code> to <code>1f</code>) are filtered.</p>

<p>All <a href="http://en.wikipedia.org/wiki/Whitespace_character#Unicode">Unicode whitespace</a> at the beginning and end of the potential filename is removed, and any Unicode whitespace within the filename is collapse to a single space character.</p>

<p><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa365247%28v=vs.85%29.aspx">Certain filenames are reserved in Windows</a> and are filtered.</p>

<p><a href="http://en.wikipedia.org/wiki/Zaru">Wait, what, Zaru?</a></p>

<p><a href="https://github.com/szTheory/zaru_crystal">zaru_crystal</a> is licensed under the terms of the MIT license.</p>
</div>
</body>
</html>
